{% extends \"layout.html\" %}\n\n{% block title %}Training Progress - {{ session.name }}{% endblock %}\n\n{% block extra_css %}\n<style>\n  /* Progress monitoring specific styles */\n  .progress-ring {\n    transform: rotate(-90deg);\n  }\n  \n  .progress-ring-circle {\n    transition: stroke-dashoffset 0.35s;\n    transform-origin: 50% 50%;\n  }\n  \n  .step-indicator {\n    transition: all 0.3s ease;\n  }\n  \n  .step-indicator.active {\n    transform: scale(1.1);\n  }\n  \n  .confidence-bar {\n    transition: width 0.5s ease;\n  }\n  \n  .log-entry {\n    animation: slideIn 0.3s ease;\n  }\n  \n  @keyframes slideIn {\n    from {\n      opacity: 0;\n      transform: translateY(-10px);\n    }\n    to {\n      opacity: 1;\n      transform: translateY(0);\n    }\n  }\n  \n  .pulse {\n    animation: pulse 2s infinite;\n  }\n  \n  @keyframes pulse {\n    0%, 100% {\n      opacity: 1;\n    }\n    50% {\n      opacity: 0.5;\n    }\n  }\n  \n  .error-highlight {\n    animation: errorFlash 0.5s ease;\n  }\n  \n  @keyframes errorFlash {\n    0%, 100% {\n      background-color: transparent;\n    }\n    50% {\n      background-color: rgba(239, 68, 68, 0.1);\n    }\n  }\n</style>\n{% endblock %}\n\n{% block content %}\n<div class=\"min-h-screen bg-gray-50 py-6\">\n  <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n    \n    <!-- Page Header -->\n    <div class=\"mb-8\">\n      <div class=\"md:flex md:items-center md:justify-between\">\n        <div class=\"flex-1 min-w-0\">\n          <nav class=\"flex\" aria-label=\"Breadcrumb\">\n            <ol class=\"flex items-center space-x-4\">\n              <li>\n                <div>\n                  <a href=\"{{ url_for('training.manage_sessions') }}\" class=\"text-gray-400 hover:text-gray-500\">\n                    <svg class=\"flex-shrink-0 h-5 w-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                      <path d=\"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z\"></path>\n                    </svg>\n                    <span class=\"sr-only\">Training Sessions</span>\n                  </a>\n                </div>\n              </li>\n              <li>\n                <div class=\"flex items-center\">\n                  <svg class=\"flex-shrink-0 h-5 w-5 text-gray-300\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path fill-rule=\"evenodd\" d=\"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z\" clip-rule=\"evenodd\"></path>\n                  </svg>\n                  <a href=\"{{ url_for('training.manage_sessions') }}\" class=\"ml-4 text-sm font-medium text-gray-500 hover:text-gray-700\">Sessions</a>\n                </div>\n              </li>\n              <li>\n                <div class=\"flex items-center\">\n                  <svg class=\"flex-shrink-0 h-5 w-5 text-gray-300\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path fill-rule=\"evenodd\" d=\"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z\" clip-rule=\"evenodd\"></path>\n                  </svg>\n                  <span class=\"ml-4 text-sm font-medium text-gray-900\">{{ session.name }}</span>\n                </div>\n              </li>\n            </ol>\n          </nav>\n          <h1 class=\"mt-2 text-3xl font-bold leading-7 text-gray-900 sm:text-4xl sm:truncate\">\n            Training Progress\n          </h1>\n          <p class=\"mt-1 text-sm text-gray-600\">\n            Real-time monitoring of {{ session.name }}\n          </p>\n        </div>\n        <div class=\"mt-4 flex md:mt-0 md:ml-4 space-x-3\">\n          <button type=\"button\" id=\"pause-training\" \n                  class=\"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n                  style=\"display: none;\">\n            <svg class=\"-ml-1 mr-2 h-5 w-5 text-gray-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z\"></path>\n            </svg>\n            Pause Training\n          </button>\n          <button type=\"button\" id=\"stop-training\" \n                  class=\"inline-flex items-center px-4 py-2 border border-red-300 rounded-md shadow-sm text-sm font-medium text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\"\n                  style=\"display: none;\">\n            <svg class=\"-ml-1 mr-2 h-5 w-5 text-red-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"></path>\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z\"></path>\n            </svg>\n            Stop Training\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- Main Progress Dashboard -->\n    <div class=\"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8\">\n      \n      <!-- Overall Progress Card -->\n      <div class=\"lg:col-span-2 bg-white overflow-hidden shadow rounded-lg\">\n        <div class=\"p-6\">\n          <div class=\"flex items-center justify-between mb-4\">\n            <h3 class=\"text-lg font-medium text-gray-900\">Overall Progress</h3>\n            <span id=\"progress-percentage\" class=\"text-2xl font-bold text-blue-600\">0%</span>\n          </div>\n          \n          <!-- Progress Bar -->\n          <div class=\"w-full bg-gray-200 rounded-full h-4 mb-4\">\n            <div id=\"main-progress-bar\" class=\"bg-blue-600 h-4 rounded-full transition-all duration-500\" style=\"width: 0%\"></div>\n          </div>\n          \n          <!-- Current Step -->\n          <div class=\"flex items-center justify-between text-sm text-gray-600\">\n            <span id=\"current-step\">Initializing...</span>\n            <span id=\"estimated-time\">Estimating...</span>\n          </div>\n          \n          <!-- Circular Progress Ring -->\n          <div class=\"flex justify-center mt-6\">\n            <div class=\"relative w-32 h-32\">\n              <svg class=\"progress-ring w-32 h-32\" viewBox=\"0 0 120 120\">\n                <circle class=\"progress-ring-circle\" stroke=\"#e5e7eb\" stroke-width=\"8\" fill=\"transparent\" r=\"52\" cx=\"60\" cy=\"60\"/>\n                <circle id=\"progress-ring-fill\" class=\"progress-ring-circle\" stroke=\"#2563eb\" stroke-width=\"8\" fill=\"transparent\" r=\"52\" cx=\"60\" cy=\"60\" stroke-dasharray=\"327\" stroke-dashoffset=\"327\"/>\n              </svg>\n              <div class=\"absolute inset-0 flex items-center justify-center\">\n                <span id=\"ring-percentage\" class=\"text-xl font-bold text-gray-900\">0%</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <!-- Status Card -->\n      <div class=\"bg-white overflow-hidden shadow rounded-lg\">\n        <div class=\"p-6\">\n          <h3 class=\"text-lg font-medium text-gray-900 mb-4\">Training Status</h3>\n          \n          <div class=\"space-y-4\">\n            <div class=\"flex justify-between\">\n              <span class=\"text-sm text-gray-600\">Status:</span>\n              <span id=\"training-status\" class=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800\">\n                In Progress\n              </span>\n            </div>\n            \n            <div class=\"flex justify-between\">\n              <span class=\"text-sm text-gray-600\">Started:</span>\n              <span id=\"start-time\" class=\"text-sm font-medium text-gray-900\">{{ session.created_at or 'Just now' }}</span>\n            </div>\n            \n            <div class=\"flex justify-between\">\n              <span class=\"text-sm text-gray-600\">Duration:</span>\n              <span id=\"duration\" class=\"text-sm font-medium text-gray-900\">00:00:00</span>\n            </div>\n            \n            <div class=\"flex justify-between\">\n              <span class=\"text-sm text-gray-600\">Files Processed:</span>\n              <span id=\"files-processed\" class=\"text-sm font-medium text-gray-900\">0 / {{ session.total_files or 0 }}</span>\n            </div>\n            \n            <div class=\"flex justify-between\">\n              <span class=\"text-sm text-gray-600\">Questions Generated:</span>\n              <span id=\"questions-generated\" class=\"text-sm font-medium text-gray-900\">0</span>\n            </div>\n            \n            <div class=\"flex justify-between\">\n              <span class=\"text-sm text-gray-600\">Avg. Confidence:</span>\n              <span id=\"avg-confidence\" class=\"text-sm font-medium text-gray-900\">-</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    \n    <!-- Training Steps Timeline -->\n    <div class=\"bg-white shadow rounded-lg mb-8\">\n      <div class=\"px-6 py-4 border-b border-gray-200\">\n        <h3 class=\"text-lg font-medium text-gray-900\">Training Steps</h3>\n      </div>\n      <div class=\"p-6\">\n        <div class=\"flow-root\">\n          <ul id=\"training-steps\" class=\"-mb-8\">\n            <!-- Steps will be populated dynamically -->\n          </ul>\n        </div>\n      </div>\n    </div>\n    \n    <!-- Confidence Score Visualization -->\n    <div class=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8\">\n      \n      <!-- Confidence Distribution -->\n      <div class=\"bg-white shadow rounded-lg\">\n        <div class=\"px-6 py-4 border-b border-gray-200\">\n          <h3 class=\"text-lg font-medium text-gray-900\">Confidence Distribution</h3>\n        </div>\n        <div class=\"p-6\">\n          <div class=\"space-y-4\">\n            <div class=\"flex items-center justify-between\">\n              <span class=\"text-sm text-gray-600\">High Confidence (≥0.8)</span>\n              <div class=\"flex items-center space-x-2\">\n                <div class=\"w-32 bg-gray-200 rounded-full h-2\">\n                  <div id=\"high-confidence-bar\" class=\"confidence-bar bg-green-600 h-2 rounded-full\" style=\"width: 0%\"></div>\n                </div>\n                <span id=\"high-confidence-count\" class=\"text-sm font-medium text-gray-900\">0</span>\n              </div>\n            </div>\n            \n            <div class=\"flex items-center justify-between\">\n              <span class=\"text-sm text-gray-600\">Medium Confidence (0.6-0.8)</span>\n              <div class=\"flex items-center space-x-2\">\n                <div class=\"w-32 bg-gray-200 rounded-full h-2\">\n                  <div id=\"medium-confidence-bar\" class=\"confidence-bar bg-yellow-600 h-2 rounded-full\" style=\"width: 0%\"></div>\n                </div>\n                <span id=\"medium-confidence-count\" class=\"text-sm font-medium text-gray-900\">0</span>\n              </div>\n            </div>\n            \n            <div class=\"flex items-center justify-between\">\n              <span class=\"text-sm text-gray-600\">Low Confidence (<0.6)</span>\n              <div class=\"flex items-center space-x-2\">\n                <div class=\"w-32 bg-gray-200 rounded-full h-2\">\n                  <div id=\"low-confidence-bar\" class=\"confidence-bar bg-red-600 h-2 rounded-full\" style=\"width: 0%\"></div>\n                </div>\n                <span id=\"low-confidence-count\" class=\"text-sm font-medium text-gray-900\">0</span>\n              </div>\n            </div>\n          </div>\n          \n          <!-- Confidence Chart Placeholder -->\n          <div class=\"mt-6\">\n            <canvas id=\"confidence-chart\" width=\"400\" height=\"200\"></canvas>\n          </div>\n        </div>\n      </div>\n      \n      <!-- Error Summary -->\n      <div class=\"bg-white shadow rounded-lg\">\n        <div class=\"px-6 py-4 border-b border-gray-200\">\n          <h3 class=\"text-lg font-medium text-gray-900\">Error Summary</h3>\n        </div>\n        <div class=\"p-6\">\n          <div class=\"space-y-4\">\n            <div class=\"flex items-center justify-between\">\n              <span class=\"text-sm text-gray-600\">Total Errors:</span>\n              <span id=\"total-errors\" class=\"text-sm font-medium text-red-600\">0</span>\n            </div>\n            \n            <div class=\"flex items-center justify-between\">\n              <span class=\"text-sm text-gray-600\">Processing Errors:</span>\n              <span id=\"processing-errors\" class=\"text-sm font-medium text-gray-900\">0</span>\n            </div>\n            \n            <div class=\"flex items-center justify-between\">\n              <span class=\"text-sm text-gray-600\">LLM Errors:</span>\n              <span id=\"llm-errors\" class=\"text-sm font-medium text-gray-900\">0</span>\n            </div>\n            \n            <div class=\"flex items-center justify-between\">\n              <span class=\"text-sm text-gray-600\">Validation Errors:</span>\n              <span id=\"validation-errors\" class=\"text-sm font-medium text-gray-900\">0</span>\n            </div>\n          </div>\n          \n          <!-- Recent Errors -->\n          <div class=\"mt-6\">\n            <h4 class=\"text-sm font-medium text-gray-900 mb-2\">Recent Errors</h4>\n            <div id=\"recent-errors\" class=\"space-y-2 max-h-32 overflow-y-auto\">\n              <p class=\"text-sm text-gray-500\">No errors reported</p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    \n    <!-- Live Logs -->\n    <div class=\"bg-white shadow rounded-lg\">\n      <div class=\"px-6 py-4 border-b border-gray-200 flex items-center justify-between\">\n        <h3 class=\"text-lg font-medium text-gray-900\">Live Training Logs</h3>\n        <div class=\"flex items-center space-x-2\">\n          <button type=\"button\" id=\"auto-scroll-toggle\" class=\"inline-flex items-center px-3 py-1 border border-gray-300 rounded text-sm font-medium text-gray-700 bg-white hover:bg-gray-50\">\n            <svg class=\"w-4 h-4 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 14l-7 7m0 0l-7-7m7 7V3\"></path>\n            </svg>\n            Auto-scroll\n          </button>\n          <button type=\"button\" id=\"clear-logs\" class=\"inline-flex items-center px-3 py-1 border border-gray-300 rounded text-sm font-medium text-gray-700 bg-white hover:bg-gray-50\">\n            <svg class=\"w-4 h-4 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"></path>\n            </svg>\n            Clear\n          </button>\n        </div>\n      </div>\n      <div class=\"p-6\">\n        <div id=\"log-container\" class=\"bg-gray-900 text-green-400 p-4 rounded-lg font-mono text-sm h-64 overflow-y-auto\">\n          <div class=\"log-entry\">[{{ session.created_at or 'now' }}] Training session initialized...</div>\n        </div>\n      </div>\n    </div>\n    \n  </div>\n</div>\n\n<!-- Connection Status Indicator -->\n<div id=\"connection-status\" class=\"fixed bottom-4 right-4 z-50\">\n  <div class=\"bg-white rounded-lg shadow-lg p-3 flex items-center space-x-2\">\n    <div id=\"connection-indicator\" class=\"w-3 h-3 bg-green-500 rounded-full pulse\"></div>\n    <span id=\"connection-text\" class=\"text-sm font-medium text-gray-900\">Connected</span>\n  </div>\n</div>\n\n{% endblock %}\n\n{% block extra_js %}\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/chart.js\"></script>\n<script src=\"{{ url_for('static', filename='js/training-progress.js') }}?v={{ range(1000, 9999) | random }}\"></script>\n{% endblock %}"